#!/bin/sh
cd "$(dirname "$0")/.."

URL="http://localhost:8000"

# ブラウザ起動関数
open_browser() {
  if command -v xdg-open >/dev/null 2>&1; then
    xdg-open "$URL"
  elif command -v open >/dev/null 2>&1; then
    open "$URL"
  elif [ "$OS" = "MINGW"* ] || [ "$OS" = "MSYS"* ] || [ "$OS" = "CYGWIN"* ]; then
    start "" "$URL"
  else
    echo "⚠️ ブラウザ自動起動不可: $URL を手動で開いてね"
  fi
}

# ブラウザ先行起動
OS="$(uname -s)"
open_browser

# Deno 実行
deno run --allow-net --allow-read ./main.js
